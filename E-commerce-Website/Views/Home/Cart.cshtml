@inject Microsoft.Extensions.Configuration.IConfiguration Configuration
@model List<Cart>
@{
	ViewData["Title"] = "Cart";
	ViewData["CurrentPage"] = "Cart";
	var adminPanelPath = Configuration["AdminPanelPath"];
}
<div class="container text-center">
	<h1>Cart</h1>
	@if (TempData["CartError"] != null)
	{
		<div class="alert alert-danger">@TempData["CartError"]</div>
	}
	<table class="table table-striped table-bordered">
		<thead>

			<tr>
				<th>Item</th>
				<th>Photo</th>
				<th>Quantity</th>
				<th>Price</th>
				<th>Action</th>
			</tr>
		</thead>
		<tbody>
			@foreach (Cart item in Model)
			{
				<tr>
					<td>
						<a asp-controller="Home" asp-action="CurrentProduct" asp-route-id="@item.ProductId">
							@item.Product.Name
						</a>
					</td>

					<td>
						<a asp-controller="Home" asp-action="CurrentProduct" asp-route-id="@item.ProductId">
							@if (item.Product != null && item.Product.Photo != null)
							{
								@if (item.Product.Photo.Length > 0 && !(item.Product.Photo.StartsWith("https://") || item.Product.Photo.StartsWith("http://")))
								{
									<img src="@adminPanelPath@("upload/" + item.Product.Photo.TrimStart('/'))" style="max-width:200px;max-height:200px" class="img-fluid" style="max-height: 400px;">
								}
								else
								{
									<img src="@item.Product.Photo" class="img-fluid" style="max-height: 400px;">
								}

							}
						</a>
					</td>
					<td>
						<form asp-action="UpdateCartQuantity" asp-controller="Home" method="post" style="display:inline;">
							<input type="hidden" name="cartId" value="@item.Id" />
							<input type="number" class="form-control" min="1" max="@item.Product.Quantity" name="quantity" value="@item.Quantity" style="width:80px;display:inline-block;" />
							<button type="submit" class="btn btn-sm btn-primary">Update</button>
						</form>
					</td>
					<td>@(item.Product.Price* item.Quantity)</td>
					<td><a class="btn btn-danger" asp-action="DeleteProductFromCart" asp-controller="Home" asp-route-id="@item.ProductId"><i class="bi-trash"></i></a></td>
				</tr>
			}
			<tr>
				<td></td>
				<td></td>
				<td>Total Price</td>
				<td>@((Decimal)ViewBag.TotalPrice)</td>

			</tr>
		</tbody>
	</table>

	<form method="post" asp-controller="Home" asp-action="AddOrder">
		<div class="container mt-3">
			<!-- Title centered -->
			<h1 class="mb-4 text-center">Place Your Order</h1>

			<!-- Name -->
			<div class="row mb-3 justify-content-center">
				<label for="name" class="col-sm-2 col-form-label text-start">Name</label>
				<div class="col-sm-6">
					<input class="form-control" id="name" name="Name" placeholder="Enter your name" />
				</div>
			</div>

			<!-- Address -->
			<div class="row mb-3 justify-content-center">
				<label for="address" class="col-sm-2 col-form-label text-start">Address</label>
				<div class="col-sm-6">
					<input class="form-control" id="address" name="Address" placeholder="Enter your address" />
				</div>
			</div>

			<!-- Email -->
			<div class="row mb-3 justify-content-center">
				<label for="email" class="col-sm-2 col-form-label text-start">Email</label>
				<div class="col-sm-6">
					<input class="form-control" id="email" name="Email" placeholder="Enter your email" />
				</div>
			</div>

			<!-- Phone -->
			<div class="row mb-3 justify-content-center">
				<label for="phone" class="col-sm-2 col-form-label text-start">Phone</label>
				<div class="col-sm-6">
					<input class="form-control" id="phone" name="Phone" placeholder="Enter your phone" />
				</div>
			</div>

			<!-- Button -->
			<div class="row justify-content-center">
				<div class="col-sm-8 text-center">
					<button type="submit" class="btn btn-primary">Order Now</button>
				</div>
			</div>
		</div>
	</form>


</div>


